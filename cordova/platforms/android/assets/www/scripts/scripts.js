var Nxt;!function(a){var b=function(){function a(){}return a.prototype.connect=function(a,b){setTimeout(b,1e3)},a.prototype.disconnect=function(a){a()},a.prototype.write=function(a){alert(a)},a.prototype.writeBinary=function(a){alert(a)},a.prototype.read=function(){},a}();a.MockConnection=b;var c=function(){function a(){null==window.bluetoothSerial&&(window.bluetoothSerial=new b)}return a.prototype.connect=function(a,b,c){window.bluetoothSerial.connect(a,b,c)},a.prototype.disconnect=function(a,b){window.bluetoothSerial.disconnect(a,b)},a.prototype.write=function(a,b,c){window.bluetoothSerial.write(a,b,c)},a.prototype.writeBinary=function(a,b,c){window.bluetoothSerial.writeBinary(a,b,c)},a.prototype.read=function(a,b){window.bluetoothSerial.read(a,b)},a}();a.BluetoothConnection=c}(Nxt||(Nxt={}));var Nxt;!function(a){var b=function(){function a(a){this._bytes=[],this.append(a)}return a.prototype.append=function(a){this._bytes=this._bytes.concat(a)},a.prototype.toArrayBuffer=function(){return console.log("NXT "+this._bytes.toString()),new Uint8Array(this._bytes).buffer},a.Types={DirectReply:0,SystemReply:1,Direct:128,System:129},a}();a.Command=b}(Nxt||(Nxt={}));var Nxt;!function(a){var b=function(){function b(){this.mode=b.Modes.On,this.power=0,this.regulation=b.Regulation.None,this.turnRatio=0,this.runState=b.RunStates.Running,this.tachoLimit=0}return b.prototype.write=function(){var b=new a.Command([12,0,a.Command.Types.Direct,4,this._port,this.power,this.mode,this.regulation,this.turnRatio,this.runState,0,0,0,0]);this._connection.writeBinary(b.toArrayBuffer(),function(){},function(a){alert(a)})},b.Modes={Coast:0,On:1,Break:3,Regulated:5},b.Regulation={None:0,Speed:1,Sync:2},b.RunStates={Idle:0,RampUp:16,Running:32,RampDown:64},b}();a.Motor=b}(Nxt||(Nxt={}));var Nxt;!function(a){var b=function(){function a(){}return a.prototype.read=function(){},a}();a.Sensor=b}(Nxt||(Nxt={}));var Nxt;!function(a){var b=function(){function b(){this._connection=null,this._connection=new a.BluetoothConnection}return Object.defineProperty(b.prototype,"portA",{get:function(){return this._portA},set:function(a){this._portA=a,a._connection=this._connection,a._port=0},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"portB",{get:function(){return this._portB},set:function(a){this._portB=a,a._connection=this._connection,a._port=1},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"portC",{get:function(){return this._portC},set:function(a){this._portC=a,a._connection=this._connection,a._port=2},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"portABC",{get:function(){return this._portABC},set:function(a){this._portABC=a,a._connection=this._connection,a._port=255},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"port1",{get:function(){return this._port1},set:function(a){this._port1=a,a._connection=this._connection,a._port=0},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"port2",{get:function(){return this._port2},set:function(a){this._port2=a,a._connection=this._connection,a._port=1},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"port3",{get:function(){return this._port3},set:function(a){this._port3=a,a._connection=this._connection,a._port=2},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"port4",{get:function(){return this._port4},set:function(a){this._port4=a,a._connection=this._connection,a._port=3},enumerable:!0,configurable:!0}),b.prototype.connect=function(a,b,c){var d=this;this._connection.connect(a,b,function(a){d._connected=!1,c(a)}),this._connected=!0},b.prototype.disconnect=function(a,b){this.isConnected()&&(this._connection.disconnect(a,b),this._connected=!1)},b.prototype.isConnected=function(){return this._connected},b.prototype.beep=function(b,c){"undefined"==typeof b&&(b=523),"undefined"==typeof c&&(c=500);var d=new a.Command([6,0,a.Command.Types.Direct,3,11,2,244,1]);this._connection.writeBinary(d.toArrayBuffer(),function(){},function(a){alert(a)})},b}();a.Brick=b}(Nxt||(Nxt={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Nxt;!function(a){var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(a.Sensor);a.SonarSensor=b}(Nxt||(Nxt={})),angular.module("legoNxtRemoteApp",["ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{redirectTo:"/remote"}).when("/remote",{templateUrl:"views/remote.html",controller:"RemoteCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("legoNxtRemoteApp").service("robotModel",[function(){var a=window.Nxt;this.mac="00:16:53:13:A3:3A",this.brick=new a.Brick,this.driveL=new a.Motor,this.driveR=new a.Motor,this.cameraLift=new a.Motor,this.brick.portA=this.driveL,this.brick.portB=this.cameraLift,this.brick.portC=this.driveR,this.isConnected=!1,this.connect=function(a){var b=this,c=function(){b.isConnected=!0,a()},d=function(){b.isConnected=!1,a()};this.brick.connect(this.mac,c,d)},this.disconnect=function(a){var b=this,c=function(){b.isConnected=!1,a()},d=function(){b.isConnected=!1,a()};this.brick.disconnect(c,d)},this.forward=function(b){var c={power:b,mode:a.Motor.Modes.On,regulation:a.Motor.Regulation.None},d={power:b,mode:a.Motor.Modes.On,regulation:a.Motor.Regulation.None};this.move(c,d)},this.backward=function(b){var c={power:-1*b,mode:a.Motor.Modes.On,regulation:a.Motor.Regulation.None},d={power:-1*b,mode:a.Motor.Modes.On,regulation:a.Motor.Regulation.None};this.move(c,d)},this.move=function(a,b){this.checkConnection()&&(this.driveL.power=a.power,this.driveL.mode=a.mode,this.driveL.regulation=a.regulation,this.driveR.power=b.power,this.driveR.mode=b.mode,this.driveR.regulation=b.regulation,this.driveL.write(!1),this.driveR.write(!1))},this.left=function(b){var c={power:-1*b,mode:a.Motor.Modes.On,regulation:a.Motor.Regulation.None},d={power:b,mode:a.Motor.Modes.On,regulation:a.Motor.Regulation.None};this.move(c,d)},this.right=function(b){var c={power:b,mode:a.Motor.Modes.On,regulation:a.Motor.Regulation.None},d={power:-1*b,mode:a.Motor.Modes.On,regulation:a.Motor.Regulation.None};this.move(c,d)},this.stop=function(){var b={power:0,mode:a.Motor.Modes.Break,regulation:a.Motor.Regulation.Speed},c={power:0,mode:a.Motor.Modes.Break,regulation:a.Motor.Regulation.Speed};this.move(b,c)},this.beep=function(){this.checkConnection()&&this.brick.beep()},this.dance=function(){alert("Not Implemented")},this.mimic=function(){alert("Not Implemented")},this.cameraUp=function(){alert("Not Implemented")},this.cameraDown=function(){alert("Not Implemented")},this.checkConnection=function(){var a=!0;return this.isConnected||(alert("Robot no longer connected."),a=!1),a}}]),angular.module("legoNxtRemoteApp").controller("RemoteCtrl",["$scope","robotModel",function(a,b){a.robot=b,a.connect=function(){var c=function(){a.$apply()};b.isConnected?b.disconnect(c):b.connect(c)}}]);